{% extends "base.html" %}
{# This template is used for both editing and adding media #}

{% block extrahead %}
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/admin_shells.css" />
    <script type="text/javascript" src="{{STATIC_URL}}js/tiny_mce/tiny_mce.js"></script>
{% endblock %}

{% block content %}

<div id="content" class="grid_8">



{% if media_obj %}
    <h2>Editing media object "{{media_obj}}"</h2>
{% else %}
    <h2>Creating new media object for page "{{page}}"</h2>
{% endif %}

<input id="page_return" class="button" type="submit" value="Return to page editor" style="margin:20px 0px;width:600px;" />


<form class="pageform" enctype="multipart/form-data" action="" method="post" accept-charset="utf-8">
	{% csrf_token %}


    <p>
        <label>{{form.title.label}}</label>
        {{form.title}}
        <span class="help_text">{{form.title.help_text|safe}}</span>
    </p>

    <p>
        <label>{{form.type.label}}</label>
        {{form.type}}<br />
        <span class="help_text">{{form.type.help_text|safe}}</span>
    </p>


    <p>
        <label>{{form.file.label}}</label>
        <span class="help_text">{{form.file.help_text|safe}} </span><br />
        {{form.file}}<br />

        {% if media_obj.type == "img" %}
             {% if media_obj.file %}
                <a href="{{MEDIA_URL}}{{media_obj.file}}"><img src="{{MEDIA_URL}}{{media_obj.file}}"  /></a>
            {% endif %}
        {% else %}
            {% if media_obj.file %}
                <strong>Currently:</strong> {{media_obj.file}}
            {% endif %}

        {% endif %}



    </p>


    <p>
        <label>{{form.embed.label}}</label>
        {{form.embed}}
        <span class="help_text">{{form.embed.help_text|safe}}</span>
    </p>

    <p>
        <label>{{form.caption.label}}</label>
        {{form.caption}}
        <span class="help_text">{{form.caption.help_text|safe}}</span>
    </p>

    <p>
    <label>Media Size Override (optional)</label>
    <span class="help_text">If used, width and height will be displayed at other than the actual media size. <br />
        Does not work for embed code from other sites.</span>
    <br />
        Width: {{form.width}} &nbsp;&nbsp;&nbsp;&nbsp;Height: {{form.height}}
    </p>

    <p>
        <label>{{form.style.label}}</label>
        {{form.style}}<br />
        <span class="help_text">{{form.style.help_text|safe}}</span>
    </p>

    <p>
        <label>{{form.poster_frame.label}}</label>
        <span class="help_text">{{form.poster_frame.help_text|safe}} </span><br />
        {{form.poster_frame}}<br />

         {% if media_obj.poster_frame %}
            <a href="{{MEDIA_URL}}{{media_obj.poster_frame}}"><img src="{{MEDIA_URL}}{{media_obj.poster_frame}}"  /></a>
        {% endif %}

    </p>

    <input class="button blue" type="submit" value="Save" style="margin-top:10px;" />


</form>

{% if media_obj %}
    <p class="alert" style="margin-left:20px;"><a href="javascript:confirmDelete('{% url admin_delete_media media_obj.id %}')">&#x2326; Delete this media</a></p>
{% endif %}

</div>




<script type="text/javascript" charset="utf-8">

// Get confirmation before deleting story
function confirmDelete(delUrl) {
  if (confirm("Are you sure you want to delete this media?")) {
    document.location = delUrl;
  }
}

$(document).ready(function(){

    {# Can't reverse URL back to page if creating new media object since we don't yet have a media object. #}
    {% if media_obj %}
        $("#page_return").click(function() {
            window.location.href = '{% url shells_admin_page media_obj.page.id %}';
        });
    {% else %}
        $("#page_return").click(function() {
            window.location.href = '{% url shells_admin_page page.id %}';
        });
    {% endif %}

});
</script>



{% endblock %}

